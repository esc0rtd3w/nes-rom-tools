--------------------------------------------
  IPS操作モジュール  ver 0.60  by わいわい
--------------------------------------------

※バージョン0.50で仕様が変更されました。
  2行の修正程度で、以前のと同じように使えます。
  変更点→ipspとipsmは合成ファイル名をrefstrに返す(オプション廃止)
  変更点→ipspとipsmで処理したファイルはipssを実行して出力する。

■概要
  Hot Soup ProcessorにIPS操作命令を追加するためのモジュールです。
  現在、IPSパッチングと、IPS差分の作成、IPSのチェックができます。

■IPSとは…
  IPSパッチはCRCチェックなどの機能を持たない原始的なパッチ方式です。
  基本的にはアドレス、相違点、相違のサイズだけをIPSデータに持ちます。
  IPSはプログラムの差分ではなく、データ修正用の差分に向いています。
  (ファイルチェックが無いので違うプログラム等にもパッチが可能ですが,それを
   実行するとコンピュータに致命的なだケージを与えることがありますから…。)

■命令
  各命令を実行すると成功/失敗をstatに返します。

  □IPSパッチを行なう
  ipsp p1,p2
	p1 : IPSファイル名
	p2 : 対象ファイル名

	stat	0	: 成功
		1	: 失敗
		2	: 異常成功(パッチするアドレスがファイルサイズを越えた)

	refstr		: 合成ファイル名(IPSファイル名.対象拡張子) 失敗時は無効


  □IPS差分を作成する
  ipsm p1,p2h
	p1 : 変更前ファイル名
	p2 : 変更後ファイル名

	stat	0	: 成功
		1	: 失敗
		2	: 失敗(比較するファイルのサイズが違う)

	refstr		: 合成ファイル名(変更後のファイル名.ips) 失敗時は無効


  □結果をファイルに出力する
  ipss p1
	p1 : 保存するファイル名

	stat	0	: 成功
		1	: 失敗

	※ipspかipsmが成功した後でしか成功しません。
	※ipspの後ならパッチ済みファイルを、ipsmの後ならIPS差分を出力します。


  □指定したファイルがIPS差分かチェックしてみる
  ipsc p1
	p1 : IPSファイル名

	stat	0	: 正常なIPSファイル
		1	: IPSファイルではない
		2	: 異常なIPSファイル


■注意事項
  付属のモジュール・スクリプトの著作権は"わいわい"にあります。
  フリーウェアで、内容を改変しない限り、転載の連絡も不要です。
  このモジュールを組込んだプログラムも自由に配布して構いません。

  大きいファイルを処理すると不正な処理になることがあります。
  高速化のためwait/await命令は使っていませんが、GUIから使うので
  必要という場合はモジュール内にWAIT系の命令を入れてください。

  モジュールを利用するには、モジュール機能に対応したHSPver2.5以上が必要です。

■履歴
 これからの予定:大きいファイルに対応
		たぶん存在するバグの修正
		異なるファイルサイズの時の処理方法の変更

  0.60  HSP2.6用モジュールを追加。
  0.50  作り直した。仕様変更。
  0.31	戻り値statに6や7を返すバグの修正。
	(情報提供：モゲモゲ様)
  0.30	既にファイルがある時の処理を変更、
	IPSファイルのチェック機能を増やした
	(情報提供：モゲモゲ様)
  0.25	パラメータに指定した変数が命令実行後に変更されるのを修正、
	GUI用のawait命令(コメント化されています)の効率を良くした、
	出力ファイルが存在する時に上書ダイアログを出すようにした、
	出力ファイル名を決めるオプションを３つずつに増やした
	(情報提供：モゲモゲ様)
  0.22	パッチ対象アドレスがファイルサイズより大きい時のバグ修正、
	差分作成時にファイルの最後が違う場合に発生するバグの修正、
	少し高速化
	(情報提供：モゲモゲ様)
  0.20	スクリプトの最適化
  0.13	IPSファイルかチェックする命令を追加
  0.12	IPS差分作成時のRLE圧縮に対応
  0.11	やっぱり存在したバグの修正
  0.10	とりあえず作る

■連絡先
  最新版は私のページで手に入るかもしれません。
	http://www.geocities.co.jp/SiliconValley/1145/

	わいわい ( geo-yy@geocities.co.jp )


